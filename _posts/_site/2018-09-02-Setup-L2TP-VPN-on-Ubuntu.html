<h1 id="how-to-setup-l2tpipsec-vpn-on-ubuntu-1604-with-networkmanager">How to Setup L2TP/IPsec VPN on Ubuntu 16.04 with NetworkManager</h1>

<p>In this article, we will learn how to setup L2TP/IPsec VPN with NetworkManager on Ubuntu 16.04. Ubuntu has stopped its support on L2TP since almost forever but there are a few workarounds and alternatives to overcome this problem.</p>

<h3 id="1-install-network-manager-l2tp-package">1) Install network-manager-l2tp Package</h3>

<p><code class="highlighter-rouge">network-manager-l2tp</code> package can be installed with adding related PPA;</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>add-apt-repository ppa:nm-l2tp/network-manager-l2tp  
<span class="nb">sudo </span>apt-get update  
<span class="nb">sudo </span>apt-get <span class="nb">install </span>network-manager-l2tp   
</code></pre></div></div>

<p>You should also install <code class="highlighter-rouge">network-manager-l2tp-gnome</code>, if you are using gnome desktop environment.</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>apt-get <span class="nb">install </span>network-manager-l2tp-gnome
</code></pre></div></div>

<h3 id="2-stop-xl2tpd-service">2) Stop xl2tpd Service</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">sudo </span>service xl2tpd stop
<span class="nb">sudo </span>update-rc.d xl2tpd disable
</code></pre></div></div>

<h3 id="3-create-your-l2tpipsec-vpn">3) Create Your L2TP/IPsec VPN</h3>

<ul>
  <li>Navigate to Settings &gt; Network &gt; Click the + button &gt; Select “Layer 2 Tunneling Protocol (L2TP)”</li>
  <li>Name the new VPN connection something</li>
  <li>Put the host name or address in the Gateway field.</li>
  <li>Put username in the Username field.</li>
  <li>Click the icon in the Password field and select your preference for how to supply the password.</li>
  <li>Click IPSec Settings…</li>
  <li>Click the box for “Enable IPsec tunnel to L2TP host”</li>
  <li>Enter the shared secret into the Pre-shared key field.</li>
  <li>Leave the Gateway ID field empty.</li>
  <li>Expand the Advanced options area</li>
  <li>Enter “3des-sha1-modp1024” into the Phase 1 Algorithms box.</li>
  <li>Enter “3des-sha1” into the Phase 2 Algorithms box.</li>
  <li>Leave the box checked for “Enforce UDP encapsulation”.</li>
  <li>Click OK.</li>
  <li>Click Save.</li>
</ul>

<p>And, thats it!</p>
